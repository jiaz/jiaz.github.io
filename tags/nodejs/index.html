<!DOCTYPE html>
<html><meta charset="utf-8" />
<title></title>

<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>nodejs &middot; Jiaji&#39;s Blog</title>
<meta name="description" content="" />


<link
    href="https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,400i,700,700i&display=swap&subset=greek,greek-ext,latin-ext"
    rel="stylesheet">
<link
    href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,400i,700|IBM+Plex+Serif:400,400i,700&display=swap&subset=cyrillic,cyrillic-ext,greek,latin-ext"
    rel="stylesheet">


<link rel="stylesheet" href="https://jiajizhou.com/css/styles.css" integrity="">


<link type="text/css" rel="stylesheet" href="https://jiajizhou.com/css/syntax.css">
<link type="text/css" rel="stylesheet" href="https://jiajizhou.com/css/all.min.css">

<base href="https://jiajizhou.com/">
<link rel="apple-touch-icon" sizes="180x180" href="https://jiajizhou.com/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jiajizhou.com/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://jiajizhou.com/favicon-16x16.png">
<link rel="manifest" href="https://jiajizhou.com/site.webmanifest">
<link rel="canonical" href="https://jiajizhou.com/tags/nodejs/">
</head>
<body>
    <div class="container mx-auto pl-8 pr-8 lg:flex">

        <div class="border-b lg:border-0 lg:flex-none lg:w-56">
            <h1>
                <a href="https://jiajizhou.com/" title="Home">Jiaji&#39;s Blog</a>
                <small></small>
            </h1>

            <nav class="pb-4 lg:border-0 lg:flex-1 lg:flex lg:flex-col">
                <a class="" href="https://jiajizhou.com/">Home</a>
                <a class=""
                    href="https://jiajizhou.com/posts">Posts</a>
                <a class="" href="https://jiajizhou.com/about/">About</a>
                </nav>

            <div class="hidden lg:block">
                <a href="https://github.com/jiaz"><i class="fab fa-lg fa-github"></i></a>
            </div>
        </div>

        <div class="lg:flex-1 mb-8">

<article>
    
</article>

<div class="posts">
    <div class="post">
    <header>
        <h1><a href="https://jiajizhou.com/2015/07/thread-local-context-in-node/">&#34;Thread-local&#34; Context in Node</a></h1>
        <p class="text-gray-500 text-sm">Jul 3, 2015</p>
    </header>
    <div><p>Recently, I'm doing some experiments to try to rewrite our Nodejs service in a more maintainable style. I'd like to write several posts to share my findings.</p></div>
    <footer class="mb-8">
        <a class="text-gray-500 text-sm" href="https://jiajizhou.com/2015/07/thread-local-context-in-node/">
            <nobr>Read more →</nobr>
        </a>
    </footer>
</div>

    
    <div class="post">
    <header>
        <h1><a href="https://jiajizhou.com/2015/05/unit-test-without-breaking-encapsulation-in-node/">Unit Test without Breaking Encapsulation in Node</a></h1>
        <p class="text-gray-500 text-sm">May 1, 2015</p>
    </header>
    <div><p>When writing unit tests, the most ugly &amp; painful &amp; stupid thing you might have to do is to expose some internal implementation of your module to the testing code so that:</p>
<ul>
<li>It is easier to enumerate all possible conditional branches to cover some edge cases; (although if you have a complex design, you can always achieve this by mocking things, however sometimes it's an overkill)</li>
<li>It is possible to inspect side effects of your code; (accept the dark side of the reality, you cannot totally avoid side effects)</li>
<li>It is easier to replace some dependencies with mocks. (although if you have a good design, you should be able to inject all dependencies, but it's not a common thing in javascript realm)</li>
</ul></div>
    <footer class="mb-8">
        <a class="text-gray-500 text-sm" href="https://jiajizhou.com/2015/05/unit-test-without-breaking-encapsulation-in-node/">
            <nobr>Read more →</nobr>
        </a>
    </footer>
</div>

    
    <div class="post">
    <header>
        <h1><a href="https://jiajizhou.com/2015/04/node-profiling-tools/">Node Profiling Tools</a></h1>
        <p class="text-gray-500 text-sm">Apr 15, 2015</p>
    </header>
    <div><p>At Hulu, we use Nodejs to build a <strong>proxy</strong> or <strong>orchestration</strong> service to expose APIs to our client applications in order to provide a unified interface (in API schema) which hides the complexity to deal with our versatile backend &ldquo;micro-services&rdquo;.</p>
<p>The reason we choose Nodejs over other technologies is that its <strong>asynchronized</strong> nature perfectly fits the requirements of the service:</p>
<ul>
<li>Handling large number of concurrent clients;</li>
<li>Requesting backend micro-services to get the data, where most of the time is spend on IO;</li>
<li>Enhancing the backend response with data from other backend micro-services.</li>
</ul>
<p>This is a typical front-tier API service that has <strong>low CPU</strong> consumption and <strong>high concurrent IO</strong> requirement.</p>
<p>However when you deploy the application to production, it is very likely that you would hit CPU bottleneck if you are not careful enough when writing code. Javascript is so flexible that can easily get you trapped into performance problem if you don't understand the execution engine (v8) well enough. Recently, I spent a lot of time doing profiling and investigating the performance issues of our service.</p>
<p>In this post, I'll list some tools and techniques I have used to profile/debug Nodejs program for daily development and production trouble-shooting as a summary of the work I've done.</p></div>
    <footer class="mb-8">
        <a class="text-gray-500 text-sm" href="https://jiajizhou.com/2015/04/node-profiling-tools/">
            <nobr>Read more →</nobr>
        </a>
    </footer>
</div>

    
    <div class="post">
    <header>
        <h1><a href="https://jiajizhou.com/2015/02/why-my-node-program-wont-exit/">Why my node program won&#39;t exit?!</a></h1>
        <p class="text-gray-500 text-sm">Feb 23, 2015</p>
    </header>
    <div><p>上周碰到一个很有意思的问题，同事找我来跑一个node的程序，结果跑完了最后一个step，但是程序没有退出。</p>
<p>这对刚从同步编程世界转过来的同学来说简直是不可思议的事情。刚开始我也以为是程序的bug，如果不是bug的话有可能是在等待某个callback，但一直没有触发，同事也不明白是为什么，正好我刚入职就让我investigate一下。之前虽然写过一些node的程序，但是都是小打小弄，所以刚开始没什么头绪。</p></div>
    <footer class="mb-8">
        <a class="text-gray-500 text-sm" href="https://jiajizhou.com/2015/02/why-my-node-program-wont-exit/">
            <nobr>Read more →</nobr>
        </a>
    </footer>
</div>

    </div>


        </div>

        <footer class="block border-t lg:hidden">
            <div class="text-center my-6">
                <a href="https://github.com/jiaz"><i class="fab fa-2x fa-github"></i></a>
            </div>
        </footer>
    </div>

</body>

</html>
